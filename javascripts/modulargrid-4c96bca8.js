var ModularGrid={};ModularGrid.Utils={},ModularGrid.Utils={updateCSSHeight:function(e,t,i){null!==e&&(e.style.height=t,i&&i())},getClientHeight:function(){var e=Math.max(document.documentElement.clientHeight,this.getDocumentBodyElement().offsetHeight);return window.scrollMaxY&&(e=Math.max(e,window.scrollMaxY)),document.documentElement.scrollHeight&&(e=Math.max(e,document.documentElement.scrollHeight)),e},getClientWidth:function(){var e=document.documentElement.clientWidth;return e},documentBodyElement:null,getDocumentBodyElement:function(){return null==this.documentBodyElement&&(this.documentBodyElement=document.getElementsByTagName("body")[0]),this.documentBodyElement},createParams:function(e,t){var i={};for(var r in e)i[r]=e[r];for(var r in t)i[r]=t[r];return i},defaultStyleValueParams:{display:"block",width:"100%",height:"100%",opacity:1,background:"transparent","float":"none",visibility:"visible",border:"0"},createStyleValue:function(e,t){var i=t||ModularGrid.Utils.defaultStyleValueParams,r=ModularGrid.Utils.createParams(i,e),n="";for(var a in r)(r[a]||0===r[a])&&(n+=a+":"+r[a]+";"),"opacity"==r[a]&&(n+="-khtml-opacity:"+r[a]+";-moz-opacity:"+r[a]+";filter:progid:DXImageTransform.Microsoft.Alpha(opacity="+100*r[a]+");");return n}},ModularGrid.Utils.EventProvider=function(e,t,i){return this.eventName=e,this.prepareParams=t,this.target=i||"document",this.handlers=null,this},ModularGrid.Utils.EventProvider.prototype.genericHandler=function(e){for(var t=this.prepareParams?this.prepareParams(e):e,i=0,r=this.handlers.length;r>i;i++)this.handlers[i](t)},ModularGrid.Utils.EventProvider.prototype.initHandlers=function(){this.handlers=[];var code=this.target+".on"+this.eventName.toLowerCase()+"=function(event){self.genericHandler(event);};",self=this;eval(code)},ModularGrid.Utils.EventProvider.prototype.addHandler=function(e){null==this.handlers&&this.initHandlers(),this.handlers[this.handlers.length]=e},ModularGrid.Utils.EventSender=function(){return this.handlers={},this},ModularGrid.Utils.EventSender.prototype.addHandler=function(e,t){this.handlers[e]||(this.handlers[e]=[]),this.handlers[e][this.handlers[e].length]=t},ModularGrid.Utils.EventSender.prototype.occurEvent=function(e,t){this.handlers[e];if(this.handlers[e])for(var i=0,r=this.handlers[e].length;r>i;i++)this.handlers[e][i](t)},ModularGrid.Utils.CookieStore={setValue:function(e,t){ModularGrid.Utils.CookieStore.setCookie(e,t)},getValue:function(e){return ModularGrid.Utils.CookieStore.getCookie(e)},setCookie:function(e,t){var i=new Date,r=new Date;r.setTime(i.getTime()+31536e6),document.cookie=e+"="+escape(t)+"; expires="+r},getCookie:function(e){var t=" "+document.cookie,i=" "+e+"=",r=null,n=0,a=0;return t.length>0&&(n=t.indexOf(i),-1!=n&&(n+=i.length,a=t.indexOf(";",n),-1==a&&(a=t.length),r=unescape(t.substring(n,a)))),r}},ModularGrid.Utils.StateChanger=function(e,t,i){return e.addHandler(function(e){t(e)&&i()}),this},ModularGrid.OpacityChanger={},ModularGrid.OpacityChanger.defaults={shouldStepUpOpacity:function(e){var t=!e.occured_in_form&&e.shiftKey&&221==e.keyCode;return t},shouldStepDownOpacity:function(e){var t=!e.occured_in_form&&e.shiftKey&&219==e.keyCode;return t},opacity:.25,opacityStep:.05},ModularGrid.OpacityChanger={params:null,eventSender:null,init:function(e){this.params=ModularGrid.Utils.createParams(this.defaults,e),this.eventSender=new ModularGrid.Utils.EventSender},setOpacity:function(e){return this.params.opacity=e,this.params.opacity=this.params.opacity<0?0:this.params.opacity,this.params.opacity=this.params.opacity>1?1:this.params.opacity,this.updateOpacity(this.params.opacity),this.params.opacity},stepDownOpacity:function(){return this.setOpacity(this.params.opacity-this.params.opacityStep)},stepUpOpacity:function(){return this.setOpacity(this.params.opacity+this.params.opacityStep)},updateOpacity:function(e){this.eventSender.occurEvent("opacityChanged",this.params.opacity)},changeElementOpacity:function(e){e&&(e.style.opacity=this.params.opacity)}},ModularGrid.Image={},ModularGrid.Image.defaults={shouldToggleVisibility:function(e){var t=!e.occured_in_form&&e.ctrlKey&&("\\"==e.character||28==e.keyCode||220==e.keyCode);return t},"z-index":255,centered:!1,marginTop:0,marginLeft:"0px",marginRight:"0px",src:"",width:100,height:100},ModularGrid.Image={showing:!1,parentElement:null,params:null,imgElement:null,eventSender:null,init:function(e){this.params=ModularGrid.Utils.createParams(this.defaults,e),this.eventSender=new ModularGrid.Utils.EventSender},createParentElement:function(e){var t=document.createElement("div"),i={position:"absolute",left:"0",top:"0",width:"100%",height:e.height+"px",opacity:1,"z-index":e["z-index"]};return t.setAttribute("style",ModularGrid.Utils.createStyleValue(i)),t.appendChild(this.createImageDOM(e)),ModularGrid.Utils.getDocumentBodyElement().appendChild(t),t},createImageDOM:function(e){var t={width:"auto",height:"auto",opacity:ModularGrid.OpacityChanger.params.opacity},i={"padding-top":e.marginTop+"px",width:"auto",height:"auto"};e.centered?(i["text-align"]="center",t.margin="0 auto"):(i["padding-left"]=e.marginLeft,i["padding-right"]=e.marginRight);var r=document.createElement("div");return r.setAttribute("style",ModularGrid.Utils.createStyleValue(i)),this.imgElement=document.createElement("img"),this.imgElement.setAttribute("src",e.src),this.imgElement.setAttribute("width",e.width),this.imgElement.setAttribute("height",e.height),this.imgElement.setAttribute("style",ModularGrid.Utils.createStyleValue(t)),r.appendChild(this.imgElement),r},opacityHandler:function(){ModularGrid.OpacityChanger.changeElementOpacity(ModularGrid.Image.imgElement)},toggleVisibility:function(){this.showing=!this.showing,this.eventSender.occurEvent("visibilityChanged",this.showing),this.showing&&null==this.parentElement&&(this.parentElement=this.createParentElement(this.params)),this.parentElement&&(this.parentElement.style.display=this.showing?"block":"none")}},ModularGrid.Guides={},ModularGrid.Guides.defaults={shouldToggleVisibility:function(e){var t=!e.occured_in_form&&e.ctrlKey&&(";"==e.character||186==e.keyCode);return t},lineStyle:"solid",lineColor:"#9dffff",lineWidth:"1px","z-index":255,items:[]},ModularGrid.Guides={showing:!1,parentElement:null,params:null,eventSender:null,init:function(e){this.params=ModularGrid.Utils.createParams(this.defaults,e),this.eventSender=new ModularGrid.Utils.EventSender},createParentElement:function(e){var t=document.createElement("div"),i=ModularGrid.Utils.createStyleValue({position:"absolute",left:"0",top:"0",height:ModularGrid.Utils.getClientHeight()+"px",width:"100%","text-align":"center","z-index":e["z-index"]});return t.setAttribute("style",i),t.innerHTML=this.createGuidesHTML(e.items),ModularGrid.Utils.getDocumentBodyElement().appendChild(t),t},createGuidesHTML:function(e){var t="";if(e)for(var i,r,n=this.params.lineWidth+" "+this.params.lineStyle+" "+this.params.lineColor+" !important",a=e.length;a--;)switch(i=e[a],r={position:"absolute"},i.type){case"center":r.width="100%",r.height="100%";var o={width:i.width,height:"100%",margin:"0 auto","border-left":n,"border-right":n};t+='<div style="'+ModularGrid.Utils.createStyleValue(r)+'"><div style="'+ModularGrid.Utils.createStyleValue(o)+'"></div></div>';break;case"vertical":r.width="0px",r.height="100%",null!=i.left&&(r.left=i.left,r["border-right"]=n),null!=i.right&&(r.right=i.right,r["border-left"]=n),t+='<div style="'+ModularGrid.Utils.createStyleValue(r)+'"></div>';break;case"horizontal":r.width="100%",r.height="0px",null!=i.top&&(r.top=i.top,r["border-bottom"]=n),null!=i.bottom&&(r.bottom=i.bottom,r["border-top"]=n),t+='<div style="'+ModularGrid.Utils.createStyleValue(r)+'"></div>'}return t},toggleVisibility:function(){this.showing=!this.showing,this.eventSender.occurEvent("visibilityChanged",this.showing),this.showing&&null==this.parentElement&&(this.parentElement=this.createParentElement(this.params)),this.parentElement&&(this.parentElement.style.display=this.showing?"block":"none")}},ModularGrid.Grid={},ModularGrid.Grid.defaults={shouldToggleVerticalGridVisibility:function(e){var t=!e.occured_in_form&&e.shiftKey&&"v"==e.character;return t},shouldToggleHorizontalGridVisibility:function(e){var t=!e.occured_in_form&&e.shiftKey&&"h"==e.character;return t},shouldToggleFontGridVisibility:function(e){var t=!e.occured_in_form&&e.shiftKey&&"f"==e.character;return t},shouldToggleVisibility:function(e){var t=!e.occured_in_form&&e.ctrlKey&&("'"==e.character||222==e.keyCode);return t},"z-index":255,color:"#F00",centered:!0,prependGutter:!1,appendGutter:!1,gutter:16,vDivisions:6,hDivisions:4,marginTop:0,marginLeft:"18px",marginRight:"18px",width:464,minWidth:464,maxWidth:null,lineHeight:16,lineStyle:"solid",lineWidth:"1px",lineColor:"#555"},ModularGrid.Grid={showing:!1,fontGridShowing:!1,fontGridParentElement:null,horizontalGridShowing:!1,horizontalGridParentElement:null,verticalGridShowing:!1,verticalGridParentElement:null,params:null,eventSender:null,init:function(e){this.params=ModularGrid.Utils.createParams(this.defaults,e),this.eventSender=new ModularGrid.Utils.EventSender},createParentElement:function(e){var t=ModularGrid.Utils.getDocumentBodyElement();return t.appendChild(this.createVerticalGridParentElement(e)),t.appendChild(this.createHorizontalGridParentElement(e)),t.appendChild(this.createFontGridParentElement(e)),t},opacityHandler:function(){ModularGrid.OpacityChanger.changeElementOpacity(ModularGrid.Grid.fontGridParentElement),ModularGrid.OpacityChanger.changeElementOpacity(ModularGrid.Grid.verticalGridParentElement),ModularGrid.OpacityChanger.changeElementOpacity(ModularGrid.Grid.horizontalGridParentElement)},createVerticalGridParentElement:function(e){return this.verticalGridParentElement=document.createElement("div"),this.verticalGridParentElement.setAttribute("style",ModularGrid.Utils.createStyleValue({position:"absolute",left:"0",top:"0",display:"none",height:ModularGrid.Utils.getClientHeight()+"px",width:"100%",opacity:ModularGrid.OpacityChanger.params.opacity,"z-index":e["z-index"]})),this.updateVerticalGridContents(),this.verticalGridParentElement},updateVerticalGridContents:function(){html=ModularGrid.Grid.createVerticalGridHTML(ModularGrid.Grid.params),ModularGrid.Grid.verticalGridParentElement.innerHTML=html},createVerticalGridHTML:function(e){var t="",i="string"==typeof e.width&&"%"==e.width.substr(e.width.length-1),r=i?e.minWidth:e.width,n=e.vDivisions-1;e.prependGutter?n++:null,e.appendGutter?n++:null;for(var a=e.gutter/r*100,o=(100-n*a)/e.vDivisions,d=e.prependGutter?a:0,l={position:"relative","float":"left","margin-right":"-"+o+"%",width:o+"%",height:ModularGrid.Utils.getClientHeight()+"px",background:e.color,opacity:e.opacity},s=e.vDivisions;s--;)l.left=d+"%",t+='<div style="'+ModularGrid.Utils.createStyleValue(l)+'"></div>',d+=a+o;var h={width:i?e.width:r+"px"};if(i&&(e.maxWidth&&(h["max-width"]=e.maxWidth+"px"),e.minWidth?h["min-width"]=e.minWidth+"px":alert("\u041e\u0448\u0438\u0431\u043a\u0430: \u043d\u0435 \u0437\u0430\u0434\u0430\u043d \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 minWidth\n\u0421\u0435\u0442\u043a\u0430 \u043c\u043e\u0436\u0435\u0442 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0442\u044c\u0441\u044f \u043d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e\n\n\u0427\u0442\u043e\u0431\u044b \u0441\u0435\u0442\u043a\u0430 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u043b\u0430\u0441\u044c \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e, \u0437\u0430\u0434\u0430\u0439\u0442\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 minWidth")),e.centered){var c={"text-align":"center"};h.margin="0 auto",t='<div style="'+ModularGrid.Utils.createStyleValue(c)+'"><div style="'+ModularGrid.Utils.createStyleValue(h)+'">'+t+"</div></div>"}else t='<div style="'+ModularGrid.Utils.createStyleValue(h)+'">'+t+"</div>";var u={width:"auto",padding:"0 "+e.marginRight+" 0 "+e.marginLeft};return t='<div style="'+ModularGrid.Utils.createStyleValue(u)+'">'+t+"</div>"},createHorizontalGridParentElement:function(e){this.horizontalGridParentElement=document.createElement("div");var t=ModularGrid.Utils.createStyleValue({position:"absolute",left:"0",top:"0",display:"none",height:ModularGrid.Utils.getClientHeight()+"px",width:"100%",opacity:ModularGrid.OpacityChanger.params.opacity,"z-index":e["z-index"]});return this.horizontalGridParentElement.setAttribute("style",t),this.updateHorizontalGridContents(),this.horizontalGridParentElement},updateHorizontalGridContents:function(){html=ModularGrid.Grid.createHorizontalGridHTML(ModularGrid.Grid.params),ModularGrid.Grid.horizontalGridParentElement.innerHTML=html},createHorizontalGridHTML:function(e){for(var t="",i=ModularGrid.Utils.getClientHeight(),r=e.marginTop,n=0,a=e.hDivisions+1,o=e.lineHeight*e.hDivisions,d={position:"absolute",width:"auto",left:e.marginLeft,right:e.marginRight,height:o+"px",background:e.color,opacity:e.opacity};i>r;)0==n&&i>r+o&&(d.top=r+"px",t+='<div style="'+ModularGrid.Utils.createStyleValue(d)+'"></div>'),r+=e.lineHeight,n++,n==a&&(n=0);return t},createFontGridParentElement:function(e){this.fontGridParentElement=document.createElement("div");var t=ModularGrid.Utils.createStyleValue({position:"absolute",left:"0",top:"0",display:"none",height:ModularGrid.Utils.getClientHeight()+"px",width:"100%",opacity:ModularGrid.OpacityChanger.params.opacity,"z-index":e["z-index"]});return this.fontGridParentElement.setAttribute("style",t),this.updateFontGridContents(),this.fontGridParentElement},updateFontGridContents:function(){html=ModularGrid.Grid.createFontGridHTML(ModularGrid.Grid.params),ModularGrid.Grid.fontGridParentElement.innerHTML=html},createFontGridHTML:function(e){for(var t="",i=ModularGrid.Utils.getClientHeight(),r=e.marginTop+e.lineHeight,n={position:"absolute",height:0,opacity:e.opacity,"border-bottom":e.lineWidth+" "+e.lineStyle+" "+e.lineColor+" !important"};i>r;)n.top=r+"px",t+='<div style="'+ModularGrid.Utils.createStyleValue(n)+'"></div>',r+=e.lineHeight;return t},toggleVisibility:function(){this.showing=!this.showing,this.fontGridShowing=this.showing,this.eventSender.occurEvent("fontVisibilityChanged",this.fontGridShowing),this.horizontalGridShowing=this.showing,this.eventSender.occurEvent("horizontalVisibilityChanged",this.horizontalGridShowing),this.verticalGridShowing=this.showing,this.eventSender.occurEvent("verticalVisibilityChanged",this.verticalGridShowing),this.eventSender.occurEvent("visibilityChanged",this.showing),this.updateFontGridVisibility(),this.updateHorizontalGridVisibility(),this.updateVerticalGridVisibility()},updateFontGridVisibility:function(){this.fontGridShowing&&null==this.fontGridParentElement&&this.createParentElement(this.params),this.fontGridParentElement&&(this.fontGridParentElement.style.display=this.fontGridShowing?"block":"none")},updateHorizontalGridVisibility:function(){this.horizontalGridShowing&&null==this.horizontalGridParentElement&&this.createParentElement(this.params),this.horizontalGridParentElement&&(this.horizontalGridParentElement.style.display=this.horizontalGridShowing?"block":"none")},updateVerticalGridVisibility:function(){this.verticalGridShowing&&null==this.verticalGridParentElement&&this.createParentElement(this.params),this.verticalGridParentElement&&(this.verticalGridParentElement.style.display=this.verticalGridShowing?"block":"none")},toggleHorizontalGridVisibility:function(e){this.horizontalGridShowing=!this.horizontalGridShowing,e||this.eventSender.occurEvent("horizontalVisibilityChanged",this.horizontalGridShowing),this.updateShowing(e),this.updateHorizontalGridVisibility()},toggleVerticalGridVisibility:function(e){this.verticalGridShowing=!this.verticalGridShowing,e||this.eventSender.occurEvent("verticalVisibilityChanged",this.verticalGridShowing),this.updateShowing(e),this.updateVerticalGridVisibility()},toggleFontGridVisibility:function(e){this.fontGridShowing=!this.fontGridShowing,e||this.eventSender.occurEvent("fontVisibilityChanged",this.fontGridShowing),this.updateShowing(e),this.updateFontGridVisibility()},updateShowing:function(e){this.showing=this.fontGridShowing||this.horizontalGridShowing||this.verticalGridShowing,e||this.eventSender.occurEvent("visibilityChanged",this.showing)}},ModularGrid.Resizer={},ModularGrid.Resizer.defaults={shouldToggleSize:function(e){var t=!e.occured_in_form&&e.shiftKey&&"r"==e.character;return t},changeTitle:!0,sizes:[]},ModularGrid.Resizer={params:null,sizes:null,currentSizeIndex:null,title:null,eventSender:null,detectDefaultSize:function(){var e=null;return"number"==typeof window.innerWidth&&"number"==typeof window.innerHeight?e={width:window.innerWidth,height:window.innerHeight}:document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?e={width:document.documentElement.clientWidth,height:document.documentElement.clientHeight}:document.body&&(document.body.clientWidth||document.body.clientHeight)&&(e={width:document.body.clientWidth,height:document.body.clientHeight}),e},getDefaultSize:function(){return this.sizes[0]},getCurrentSize:function(){return this.sizes[this.currentSizeIndex]},init:function(e,t){this.params=ModularGrid.Utils.createParams(this.defaults,e),this.eventSender=new ModularGrid.Utils.EventSender;var i=this.detectDefaultSize();if(i){var r=[i],n=this.params.sizes;if(n.length)for(var a=0,o=n.length;o>a;a++)r[r.length]=n[a];else t.params.minWidth&&(r[r.length]={width:t.params.minWidth});r.length>1&&(this.params.changeTitle&&(this.title=document.title),this.sizes=r,this.currentSizeIndex=0)}},sizeTitle:function(e){var t,i=this.sizes[e],r=this.sizes[0];if(i.title)t=i.title;else{var n=i.width?i.width:r.width,a=i.height?i.height:r.height;t=n+"\xd7"+a}return t},selectSize:function(e){this.currentSizeIndex=e,this.applySize()},toggleSize:function(){null!=this.currentSizeIndex&&(this.currentSizeIndex++,this.currentSizeIndex=this.currentSizeIndex==this.sizes.length?0:this.currentSizeIndex,this.applySize())},applySize:function(){var e=this.getCurrentSize().width?this.getCurrentSize().width:this.getDefaultSize().width,t=this.getCurrentSize().height?this.getCurrentSize().height:this.getDefaultSize().height;if(window.resizeTo(e,t),this.params.changeTitle){var i=this.currentSizeIndex?this.title+" ("+e+"\xd7"+t+")":this.title;this.getCurrentSize().title&&(i=this.getCurrentSize().title),document.title=i}this.eventSender.occurEvent("sizeChanged",this.currentSizeIndex)}},ModularGrid.GUI={params:null,togglerElement:null,paneElement:null,paneShowing:!0,checkboxes:{},init:function(e){this.params=ModularGrid.Utils.createParams(this.defaults,e)},create:function(){this.createToggler(),this.createPane()},createToggler:function(){var e=this;e.togglerElement=document.createElement("button"),e.togglerElement.innerHTML=e.params.toggler.label;var t=ModularGrid.Utils.createStyleValue(e.params.toggler.style,{});e.togglerElement.setAttribute("style",t),ModularGrid.Utils.getDocumentBodyElement().appendChild(e.togglerElement),e.togglerElement.onclick=function(){e.paneShowing=!e.paneShowing,e.paneElement.style.display=e.paneShowing?"block":"none"}},createPaneCheckboxItemHTML:function(e,t,i){var r=i||"",n='<div style="width:auto;'+r+'">';return n+='<input type="checkbox" id="'+e+'">',n+='<label for="'+e+'">&nbsp;'+t+"</label>",n+="</div>"},createPane:function(){var e=this;e.paneElement=document.createElement("div");var t=e.params.pane.style,i=ModularGrid.Utils.createStyleValue(t,{});e.paneElement.setAttribute("style",i);var r={},n="";if(r.guides=e.generateId()+"guides",n+=e.createPaneCheckboxItemHTML(r.guides,e.params.pane.labels.guides),r.grid=e.generateId()+"grid",n+=e.createPaneCheckboxItemHTML(r.grid,e.params.pane.labels.grid.all,"margin:1em 0 0"),r.font_grid=e.generateId()+"fontgrid",n+=e.createPaneCheckboxItemHTML(r.font_grid,e.params.pane.labels.grid.font,"padding:0 0 0 1em"),r.vertical_grid=e.generateId()+"verticalgrid",n+=e.createPaneCheckboxItemHTML(r.vertical_grid,e.params.pane.labels.grid.vertical,"padding:0 0 0 1em"),r.horizontal_grid=e.generateId()+"horizontalgrid",n+=e.createPaneCheckboxItemHTML(r.horizontal_grid,e.params.pane.labels.grid.horizontal,"padding:0 0 1em 1em"),r.image=e.generateId()+"image",n+=e.createPaneCheckboxItemHTML(r.image,e.params.pane.labels.image,"margin:0 0 1em"),ModularGrid.Resizer.sizes.length&&(n+='<div style="width:auto">',r.sizes=e.generateId()+"sizes",n+='<select size="1" id="'+r.sizes+'"><option>'+this.params.pane.labels.size+"</option></select>",n+="</div>"),n+='<div style="width:auto;margin:1em 0 0">',r.opacity_down=e.generateId()+"opacitydown",r.opacity_up=e.generateId()+"opacityup",r.opacity_value=e.generateId()+"opacityvalue",e.params.pane.labels.opacity&&(n+=e.params.pane.labels.opacity+"<br>"),n+='<button id="'+r.opacity_down+'">-</button>&nbsp;',n+='<span id="'+r.opacity_value+'">'+ModularGrid.OpacityChanger.params.opacity.toFixed(2)+"</span>",n+='&nbsp;<button id="'+r.opacity_up+'">+</button>',n+="</div>",e.paneElement.innerHTML=n,ModularGrid.Utils.getDocumentBodyElement().appendChild(this.paneElement),e.checkboxes.guides=document.getElementById(r.guides),e.checkboxes.guides&&(e.checkboxes.guides.onclick=function(){ModularGrid.Guides.toggleVisibility()},ModularGrid.Guides.eventSender.addHandler("visibilityChanged",function(t){e.checkboxes.guides.checked=t})),e.checkboxes.grid=document.getElementById(r.grid),e.checkboxes.grid&&(e.checkboxes.grid.onclick=function(){ModularGrid.Grid.toggleVisibility()},ModularGrid.Grid.eventSender.addHandler("visibilityChanged",function(t){e.checkboxes.grid.checked=t})),e.checkboxes.font_grid=document.getElementById(r.font_grid),e.checkboxes.font_grid&&(e.checkboxes.font_grid.onclick=function(){ModularGrid.Grid.toggleFontGridVisibility()},ModularGrid.Grid.eventSender.addHandler("fontVisibilityChanged",function(t){e.checkboxes.font_grid.checked=t})),e.checkboxes.vertical_grid=document.getElementById(r.vertical_grid),e.checkboxes.vertical_grid&&(e.checkboxes.vertical_grid.onclick=function(){ModularGrid.Grid.toggleVerticalGridVisibility()},ModularGrid.Grid.eventSender.addHandler("verticalVisibilityChanged",function(t){e.checkboxes.vertical_grid.checked=t})),e.checkboxes.horizontal_grid=document.getElementById(r.horizontal_grid),e.checkboxes.horizontal_grid&&(e.checkboxes.horizontal_grid.onclick=function(){ModularGrid.Grid.toggleHorizontalGridVisibility()},ModularGrid.Grid.eventSender.addHandler("horizontalVisibilityChanged",function(t){e.checkboxes.horizontal_grid.checked=t})),e.checkboxes.image=document.getElementById(r.image),e.checkboxes.image&&(e.checkboxes.image.onclick=function(){ModularGrid.Image.toggleVisibility()},ModularGrid.Image.eventSender.addHandler("visibilityChanged",function(t){e.checkboxes.image.checked=t})),e.checkboxes.sizes=document.getElementById(r.sizes),e.checkboxes.sizes){for(var a="",o=0,d=ModularGrid.Resizer.sizes.length;d>o;o++)a+="<option>"+ModularGrid.Resizer.sizeTitle(o)+"</option>";e.checkboxes.sizes.innerHTML+=a,e.checkboxes.sizes.onchange=function(){ModularGrid.Resizer.selectSize(e.checkboxes.sizes.selectedIndex-1)},ModularGrid.Resizer.eventSender.addHandler("sizeChanged",function(t){e.checkboxes.sizes.selectedIndex=t+1})}e.checkboxes.opacity_value=document.getElementById(r.opacity_value),e.checkboxes.opacity_value&&ModularGrid.OpacityChanger.eventSender.addHandler("opacityChanged",function(t){e.checkboxes.opacity_value.innerHTML=t.toFixed(2)}),e.checkboxes.opacity_up=document.getElementById(r.opacity_up),e.checkboxes.opacity_up&&(e.checkboxes.opacity_up.onclick=function(){ModularGrid.OpacityChanger.stepUpOpacity()}),e.checkboxes.opacity_down=document.getElementById(r.opacity_down),e.checkboxes.opacity_down&&(e.checkboxes.opacity_down.onclick=function(){ModularGrid.OpacityChanger.stepDownOpacity()})},generateId:function(){var e="_mdg",t=new Date;return t=e+t.getTime()}},ModularGrid.GUI.defaults={toggler:{style:{position:"absolute",right:"10px",top:"10px","z-index":1e3},label:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0441\u0435\u0442\u043a\u0438"},pane:{style:{position:"absolute",right:"10px",top:"35px",width:"auto",height:"auto",margin:"0",padding:"7px 5px",background:"#FFF",border:"2px solid #CCC","z-index":1e3},labels:{guides:'\u0433\u0430\u0439\u0434\u044b <span style="color:#555;font-size:80%;margin-left:0.75em">Ctrl + ;</span>',size:"\u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0440\u0430\u0437\u043c\u0435\u0440 (Shift + r)",grid:{all:'\u0441\u0435\u0442\u043a\u0430 <span style="color:#555;font-size:80%;margin-left:0.75em">Ctrl + \'</span>',font:'\u0448\u0440\u0438\u0444\u0442\u043e\u0432\u0430\u044f <span style="color:#555;font-size:80%;margin-left:0.75em">Shift + f</span>',vertical:'\u0432\u0435\u0440\u0442\u0438\u043a\u0430\u043b\u044c\u043d\u0430\u044f <span style="color:#555;font-size:80%;margin-left:0.75em">Shift + v</span>',horizontal:'\u0433\u043e\u0440\u0438\u0437\u043e\u043d\u0442\u0430\u043b\u044c\u043d\u0430\u044f <span style="color:#555;font-size:80%;margin-left:0.75em">Shift + h</span>'},image:'\u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435-\u043c\u0430\u043a\u0435\u0442 <span style="color:#555;font-size:80%;margin-left:0.75em">Ctrl + \\</span>',opacity:"\u043f\u0440\u043e\u0437\u0440\u0430\u0447\u043d\u043e\u0441\u0442\u044c"}}},ModularGrid.keyDownEventProvider=null,ModularGrid.resizeEventProvider=null,ModularGrid.getResizeEventProvider=function(){return null==this.resizeEventProvider&&(this.resizeEventProvider=new ModularGrid.Utils.EventProvider("resize",function(e){return{event:e}},"window")),this.resizeEventProvider},ModularGrid.getKeyDownEventProvider=function(){return null==this.keyDownEventProvider&&(this.keyDownEventProvider=new ModularGrid.Utils.EventProvider("keydown",function(e){var t=e||window.event,i=t.keyCode?t.keyCode:t.which?t.which:t.keyChar,r=String.fromCharCode(i).toLowerCase(),n={"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":":","'":'"',",":"<",".":">","/":"?","\\":"|"};t.shiftKey&&n[r]&&(r=n[r]);var a=t.target?t.target:t.srcElement;a&&3==a.nodeType&&(a=a.parentNode);var o=a&&("INPUT"==a.tagName||"TEXTAREA"==a.tagName);return{occured_in_form:o,character:r,keyCode:i,altKey:t.altKey,shiftKey:t.shiftKey,ctrlKey:t.ctrlKey,event:t}})),this.keyDownEventProvider},ModularGrid.init=function(e){var t=this,i=ModularGrid.Utils.CookieStore;this.OpacityChanger.init(e.opacity);new ModularGrid.Utils.StateChanger(this.getKeyDownEventProvider(),this.OpacityChanger.params.shouldStepUpOpacity,function(){t.OpacityChanger.stepUpOpacity()}),new ModularGrid.Utils.StateChanger(this.getKeyDownEventProvider(),this.OpacityChanger.params.shouldStepDownOpacity,function(){t.OpacityChanger.stepDownOpacity()});this.OpacityChanger.eventSender.addHandler("opacityChanged",function(e){i.setValue("o",e)}),this.Image.init(e.image),this.OpacityChanger.eventSender.addHandler("opacityChanged",this.Image.opacityHandler);new ModularGrid.Utils.StateChanger(this.getKeyDownEventProvider(),this.Image.params.shouldToggleVisibility,function(){t.Image.toggleVisibility()});t.Guides.init(e.guides);new ModularGrid.Utils.StateChanger(t.getKeyDownEventProvider(),t.Guides.params.shouldToggleVisibility,function(){t.Guides.toggleVisibility()});t.Guides.eventSender.addHandler("visibilityChanged",function(e){i.setValue("g",e)}),this.Grid.init(e.grid),this.OpacityChanger.eventSender.addHandler("opacityChanged",this.Grid.opacityHandler);new ModularGrid.Utils.StateChanger(this.getKeyDownEventProvider(),this.Grid.params.shouldToggleVisibility,function(){t.Grid.toggleVisibility()});t.Grid.eventSender.addHandler("visibilityChanged",function(e){i.setValue("v",t.Grid.verticalGridShowing),i.setValue("h",t.Grid.horizontalGridShowing),i.setValue("f",t.Grid.fontGridShowing)});new ModularGrid.Utils.StateChanger(this.getKeyDownEventProvider(),this.Grid.params.shouldToggleFontGridVisibility,function(){t.Grid.toggleFontGridVisibility()});t.Grid.eventSender.addHandler("fontVisibilityChanged",function(e){i.setValue("f",t.Grid.fontGridShowing)});new ModularGrid.Utils.StateChanger(this.getKeyDownEventProvider(),this.Grid.params.shouldToggleHorizontalGridVisibility,function(){t.Grid.toggleHorizontalGridVisibility()});t.Grid.eventSender.addHandler("horizontalVisibilityChanged",function(e){i.setValue("h",t.Grid.horizontalGridShowing)});new ModularGrid.Utils.StateChanger(this.getKeyDownEventProvider(),this.Grid.params.shouldToggleVerticalGridVisibility,function(){t.Grid.toggleVerticalGridVisibility()});t.Grid.eventSender.addHandler("verticalVisibilityChanged",function(e){i.setValue("v",t.Grid.verticalGridShowing)}),t.Resizer.init(e.resizer,t.Grid);new ModularGrid.Utils.StateChanger(t.getKeyDownEventProvider(),t.Resizer.params.shouldToggleSize,function(){t.Resizer.toggleSize()});ModularGrid.getResizeEventProvider().addHandler(function(e){var t=ModularGrid.Utils.getClientHeight()+"px";ModularGrid.Utils.updateCSSHeight(ModularGrid.Grid.horizontalGridParentElement,t,ModularGrid.Grid.updateHorizontalGridContents),ModularGrid.Utils.updateCSSHeight(ModularGrid.Grid.fontGridParentElement,t,ModularGrid.Grid.updateFontGridContents),ModularGrid.Utils.updateCSSHeight(ModularGrid.Grid.verticalGridParentElement,t,ModularGrid.Grid.updateVerticalGridContents),ModularGrid.Utils.updateCSSHeight(ModularGrid.Guides.parentElement,t)}),t.GUI.init(e.gui),t.GUI.create(),"true"==i.getValue("i")&&t.Image.toggleVisibility();var r=parseFloat(i.getValue("o"));isNaN(r)||t.OpacityChanger.setOpacity(r),"true"==i.getValue("g")&&t.Guides.toggleVisibility(),"true"==i.getValue("v")&&t.Grid.toggleVerticalGridVisibility(!0),"true"==i.getValue("h")&&t.Grid.toggleHorizontalGridVisibility(!0),"true"==i.getValue("f")&&t.Grid.toggleFontGridVisibility(!0),t.Grid.updateShowing(!0)},ModularGrid.init({guides:{shouldToggleVisibility:function(e){var t=!e.occured_in_form&&e.ctrlKey&&(";"==e.character||186==e.keyCode);return t},lineStyle:"solid",lineColor:"#9dffff",lineWidth:"1px","z-index":255,items:[{type:"center",width:"1050px"},{type:"vertical",left:"33%"},{type:"horizontal",top:"65px"}]},grid:{shouldToggleVerticalGridVisibility:function(e){var t=!e.occured_in_form&&e.shiftKey&&"v"==e.character;return t},shouldToggleHorizontalGridVisibility:function(e){var t=!e.occured_in_form&&e.shiftKey&&"h"==e.character;return t},shouldToggleFontGridVisibility:function(e){var t=!e.occured_in_form&&e.shiftKey&&"f"==e.character;return t},shouldToggleVisibility:function(e){var t=!e.occured_in_form&&e.ctrlKey&&("'"==e.character||222==e.keyCode);return t},"z-index":255,color:"#F00",centered:!0,prependGutter:!1,appendGutter:!1,gutter:16,vDivisions:12,hDivisions:3,marginTop:0,marginLeft:"0px",marginRight:"0px",width:978,minWidth:null,maxWidth:null,lineHeight:18,lineStyle:"solid",lineWidth:"1px",lineColor:"#555"},resizer:{shouldToggleSize:function(e){var t=!e.occured_in_form&&e.shiftKey&&"r"==e.character;return t},changeTitle:!0,sizes:[{width:640,height:480},{width:800,height:600},{width:1024,height:768},{width:1280,height:1024}]},image:{shouldToggleVisibility:function(e){var t=!e.occured_in_form&&e.ctrlKey&&("\\"==e.character||28==e.keyCode||220==e.keyCode);return t},"z-index":255,opacity:.85,opacityStep:.05,centered:!0,marginTop:100,marginLeft:"0px",marginRight:"0px",src:"design.png",width:300,height:356},opacity:{shouldStepUpOpacity:function(e){var t=!e.occured_in_form&&e.shiftKey&&221==e.keyCode;return t},shouldStepDownOpacity:function(e){var t=!e.occured_in_form&&e.shiftKey&&219==e.keyCode;return t},opacity:.25,opacityStep:.05},gui:{toggler:{style:{position:"absolute",right:"10px",top:"10px","z-index":1e3},label:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0441\u0435\u0442\u043a\u0438"},pane:{style:{position:"absolute",right:"10px",top:"35px",width:"auto",height:"auto",margin:"0",padding:"7px 5px",background:"#FFF",border:"2px solid #CCC","z-index":1e3},labels:{guides:'\u0433\u0430\u0439\u0434\u044b <span style="color:#555;font-size:80%;margin-left:0.75em">Ctrl + ;</span>',size:"\u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0440\u0430\u0437\u043c\u0435\u0440 (Shift + r)",grid:{all:'\u0441\u0435\u0442\u043a\u0430 <span style="color:#555;font-size:80%;margin-left:0.75em">Ctrl + \'</span>',font:'\u0448\u0440\u0438\u0444\u0442\u043e\u0432\u0430\u044f <span style="color:#555;font-size:80%;margin-left:0.75em">Shift + f</span>',vertical:'\u0432\u0435\u0440\u0442\u0438\u043a\u0430\u043b\u044c\u043d\u0430\u044f <span style="color:#555;font-size:80%;margin-left:0.75em">Shift + v</span>',horizontal:'\u0433\u043e\u0440\u0438\u0437\u043e\u043d\u0442\u0430\u043b\u044c\u043d\u0430\u044f <span style="color:#555;font-size:80%;margin-left:0.75em">Shift + h</span>'},image:'\u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435-\u043c\u0430\u043a\u0435\u0442 <span style="color:#555;font-size:80%;margin-left:0.75em">Ctrl + </span>',
opacity:"\u043f\u0440\u043e\u0437\u0440\u0430\u0447\u043d\u043e\u0441\u0442\u044c"}}}});